C51 COMPILER V9.59.0.0   TIME_CLOCK                                                        03/21/2019 20:02:16 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE TIME_CLOCK
OBJECT MODULE PLACED IN .\Objects\time_clock.obj
COMPILER INVOKED BY: E:\Programs\keil9\C51\BIN\C51.EXE time_clock.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\
                    -Listings\time_clock.lst) TABS(2) OBJECT(.\Objects\time_clock.obj)

line level    source

   1          /****************************************Copyright (c)****************************************************
   2          **--------------File Info---------------------------------------------------------------------------------
   3          ** File name:              time_clock.c
   4          ** Latest modified Date:    2019-03-21
   5          ** Latest Version:          
   6          ** Descriptions:            数码管显示时间
   7          **--------------------------------------------------------------------------------------------------------
   8          ** Created by:              张桂荧
   9          ** Created date:            2019-03-21
  10          ** Version:                 
  11          ** Descriptions:            宏定义与引脚配置，头文件相关
  12          **--------------------------------------------------------------------------------------------------------
  13          *********************************************************************************************************/
  14          
  15          #include"time_clock.h"
  16          
  17          code char* arrhour[24]={"0","1","2","3","4","5","6","7","8","9","10",\
  18          "11","12","13","14","15","16","17","18","19","20","21","22","23"};
  19          code char* arrminute[60]={  "0", "1", "2", "3", "4", "5", "6", "7", "8", "9", \
  20                              "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", \
  21                              "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31",\ 
  22                              "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", \
  23                              "43", "44", "45", "46", "47", "48", "49", "50", "51", "52", "53", \
  24                              "54", "55", "56", "57", "58", "59"};
  25          code char* arrsecond[60]={  "00", "01", "02", "03", "04", "05", "06", "07", "08", "09", \
  26                              "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20",\ 
  27                              "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", \
  28                              "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42",\ 
  29                              "43", "44", "45", "46", "47", "48", "49", "50", "51", "52", "53", \
  30                              "54", "55", "56", "57", "58", "59"};
  31          
  32          
  33          int count=0;
  34          
  35          /*********************************************************************************************************
  36          ** Function name:           display_time
  37          ** Descriptions:            通过计数来模拟时间，并在数码管上展示
  38          ** input parameters:        char h, char m, char s
  39          ** output parameters:       none
  40          ** Returned value:          none
  41          *********************************************************************************************************/
             -                    
  42          void display_time(char h, char m, char s){
  43   1        char buf[9];
  44   1        concat(buf,arrhour[h],arrminute[m],arrsecond[s]);
  45   1        //concat(buf,"12","30","25"); 
  46   1        led_display_puts(buf);
  47   1            //运行一次大约执行31条指令（不考虑进入if）
  48   1            //有的指令周期为1，有的为2，我们取平均值1.5
  49   1            //1.5*31=46.5,   46.5*21500约等于10^6，也就是1s
  50   1            while(1){
  51   2              led_display_scan();             
  52   2              count++;
  53   2              if(count==21500){
C51 COMPILER V9.59.0.0   TIME_CLOCK                                                        03/21/2019 20:02:16 PAGE 2   

  54   3                count=0;                    
  55   3                s++;
  56   3                if(s==60){
  57   4                  s=0;
  58   4                  m++;
  59   4                  if(m==60){
  60   5                    h++;
  61   5                    if(h==24)
  62   5                    h=0;            
  63   5                  }
  64   4                }
  65   3              concat(buf,arrhour[h],arrminute[m],arrsecond[s]);
  66   3              led_display_puts(buf);
  67   3            }
  68   2          }
  69   1      
  70   1      }
  71          
  72          
  73          /*********************************************************************************************************
  74          ** Function name:           concat
  75          ** Descriptions:            将小时，分钟，秒数三个字符串拼接到buf字符串
  76          ** input parameters:        char *h,char *m, char *s
  77          ** output parameters:       buf
  78          ** Returned value:          none
  79          *********************************************************************************************************/
  80          void concat(char buf[9],char *h,char *m, char *s){
  81   1        buf[0] = *h;
  82   1        buf[1] = h[1];
  83   1        buf[2]='.';
  84   1        buf[3] = *m;
  85   1        buf[4] = m[1];
  86   1        buf[5]='.';
  87   1        buf[6] = *s;
  88   1        buf[7] = s[1];
  89   1        buf[8] = '\0';
  90   1      }
  91                              
  92          /*********************************************************************************************************
  93            END FILE
  94          *********************************************************************************************************/
  95          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    399    ----
   CONSTANT SIZE    =    632    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      2      24
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
