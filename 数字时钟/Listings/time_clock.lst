C51 COMPILER V9.59.0.0   TIME_CLOCK                                                        03/25/2019 19:54:11 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE TIME_CLOCK
OBJECT MODULE PLACED IN .\Objects\time_clock.obj
COMPILER INVOKED BY: E:\Programs\keil9\C51\BIN\C51.EXE time_clock.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\
                    -Listings\time_clock.lst) TABS(2) OBJECT(.\Objects\time_clock.obj)

line level    source

   1          /****************************************Copyright (c)****************************************************
   2          **--------------File Info---------------------------------------------------------------------------------
   3          ** File name:              time_clock.c
   4          ** Latest modified Date:    2019-03-21
   5          ** Latest Version:          
   6          ** Descriptions:            数码管显示时间
   7          **--------------------------------------------------------------------------------------------------------
   8          ** Created by:              张桂荧
   9          ** Created date:            2019-03-21
  10          ** Version:                 
  11          ** Descriptions:            宏定义与引脚配置，头文件相关
  12          **--------------------------------------------------------------------------------------------------------
  13          *********************************************************************************************************/
  14          
  15          #include"time_clock.h"
  16          #include"C:\Users\CreaQi\OneDrive\文档\课程\单片机\uVision_Project\键盘\key_board.h"
  17          //储存小时
  18          code char* arr_hour[24]={"0","1","2","3","4","5","6","7","8","9","10",\
  19                                  "11","12","13","14","15","16","17","18","19",
  20                                "20","21","22","23"};
  21          
  22          //储存分钟
  23          code char* arr_minute[60]={ "0", "1", "2", "3", "4", "5", "6", "7", "8", "9", \
  24                              "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", \
  25                              "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31",\ 
  26                              "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", \
  27                              "43", "44", "45", "46", "47", "48", "49", "50", "51", "52", "53", \
  28                              "54", "55", "56", "57", "58", "59"};
  29          
  30          //储存秒数
  31          code char* arr_second[60]={ "00", "01", "02", "03", "04", "05", "06", "07", "08", "09", \
  32                              "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20",\ 
  33                              "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", \
  34                              "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42",\ 
  35                              "43", "44", "45", "46", "47", "48", "49", "50", "51", "52", "53", \
  36                              "54", "55", "56", "57", "58", "59"};
  37          
  38          
  39          int count=0;
  40          
  41          /*********************************************************************************************************
  42          ** Function name:           display_time
  43          ** Descriptions:            通过计数来模拟时间，并在数码管上展示
  44          ** input parameters:        char h, char m, char s
  45          ** output parameters:       none
  46          ** Returned value:          none
  47          *********************************************************************************************************/
             -                    
  48          void display_time(char h, char m, char s){
  49   1        char buf[9]={0},k;
  50   1        //将传入的时分秒连接到buf中
  51   1        concat(buf,arr_hour[h],arr_minute[m],arr_second[s]);
  52   1        //调用数码管驱动的api
  53   1        led_display_puts(buf);  
C51 COMPILER V9.59.0.0   TIME_CLOCK                                                        03/25/2019 19:54:11 PAGE 2   

  54   1        
  55   1            while(1){       
  56   2              led_display_scan(); 
  57   2              //检测按键
  58   2              k = get_key();
  59   2              key_shake_eliminate();
  60   2              //-2相当于'*'键
  61   2              if(k==-2) break;
  62   2              //每一次循环都将count加1        
  63   2              count++;
  64   2              //等于7说明时间为1s
  65   2              if(count==7){
  66   3                count=0;                    
  67   3                s++;
  68   3                //关闭led灯
  69   3                P1=0XFF;
  70   3                if(s==60){
  71   4                  s=0;
  72   4                  //当秒数达到0开启数码管
  73   4                  P1=0x0;
  74   4                  m++;
  75   4                  if(m==60){
  76   5                    h++;
  77   5                    if(h==24)
  78   5                    h=0;            
  79   5                  }
  80   4                }
  81   3              concat(buf,arr_hour[h],arr_minute[m],arr_second[s]);
  82   3              //将得到的时间更新显示
  83   3              led_display_puts(buf);
  84   3            }
  85   2          }
  86   1      
  87   1      }
  88          
  89          
  90          
  91          
  92          /*********************************************************************************************************
  93          ** Function name:           concat
  94          ** Descriptions:            将小时，分钟，秒数三个字符串拼接到buf字符串
  95          ** input parameters:        char *h,char *m, char *s
  96          ** output parameters:       buf
  97          ** Returned value:          none
  98          *********************************************************************************************************/
  99          void concat(char buf[9],char *h,char *m, char *s){
 100   1        buf[0] = *h;
 101   1        buf[1] = h[1];
 102   1        buf[2]='.';
 103   1        buf[3] = *m;
 104   1        buf[4] = m[1];
 105   1        buf[5]='.';
 106   1        buf[6] = *s;
 107   1        buf[7] = s[1];
 108   1        buf[8] = '\0';
 109   1      }
 110          
 111          
 112                              
 113          /*********************************************************************************************************
 114            END FILE
 115          *********************************************************************************************************/
C51 COMPILER V9.59.0.0   TIME_CLOCK                                                        03/25/2019 19:54:11 PAGE 3   

 116          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    438    ----
   CONSTANT SIZE    =    641    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      2      25
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
