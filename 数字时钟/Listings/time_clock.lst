C51 COMPILER V9.59.0.0   TIME_CLOCK                                                        03/21/2019 22:28:49 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE TIME_CLOCK
OBJECT MODULE PLACED IN .\Objects\time_clock.obj
COMPILER INVOKED BY: E:\Programs\keil9\C51\BIN\C51.EXE time_clock.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\
                    -Listings\time_clock.lst) TABS(2) OBJECT(.\Objects\time_clock.obj)

line level    source

   1          /****************************************Copyright (c)****************************************************
   2          **--------------File Info---------------------------------------------------------------------------------
   3          ** File name:              time_clock.c
   4          ** Latest modified Date:    2019-03-21
   5          ** Latest Version:          
   6          ** Descriptions:            数码管显示时间
   7          **--------------------------------------------------------------------------------------------------------
   8          ** Created by:              张桂荧
   9          ** Created date:            2019-03-21
  10          ** Version:                 
  11          ** Descriptions:            宏定义与引脚配置，头文件相关
  12          **--------------------------------------------------------------------------------------------------------
  13          *********************************************************************************************************/
  14          
  15          #include"time_clock.h"
  16          #include"C:\Users\CreaQi\OneDrive\文档\课程\单片机\uVision_Project\键盘\key_board.h"
  17          
  18          code char* arrhour[24]={"0","1","2","3","4","5","6","7","8","9","10",\
  19          "11","12","13","14","15","16","17","18","19","20","21","22","23"};
  20          code char* arrminute[60]={  "0", "1", "2", "3", "4", "5", "6", "7", "8", "9", \
  21                              "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", \
  22                              "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31",\ 
  23                              "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", \
  24                              "43", "44", "45", "46", "47", "48", "49", "50", "51", "52", "53", \
  25                              "54", "55", "56", "57", "58", "59"};
  26          code char* arrsecond[60]={  "00", "01", "02", "03", "04", "05", "06", "07", "08", "09", \
  27                              "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20",\ 
  28                              "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", \
  29                              "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42",\ 
  30                              "43", "44", "45", "46", "47", "48", "49", "50", "51", "52", "53", \
  31                              "54", "55", "56", "57", "58", "59"};
  32          
  33          
  34          int count=0;
  35          
  36          /*********************************************************************************************************
  37          ** Function name:           display_time
  38          ** Descriptions:            通过计数来模拟时间，并在数码管上展示
  39          ** input parameters:        char h, char m, char s
  40          ** output parameters:       none
  41          ** Returned value:          none
  42          *********************************************************************************************************/
             -                    
  43          void display_time(char h, char m, char s){
  44   1        char buf[9],k;
  45   1        concat(buf,arrhour[h],arrminute[m],arrsecond[s]);
  46   1        //concat(buf,"12","30","25"); 
  47   1        led_display_puts(buf);
  48   1            //运行一次大约执行31条指令（不考虑进入if）
  49   1            //有的指令周期为1，有的为2，我们取平均值1.5
  50   1            //1.5*31=46.5,   46.5*21500约等于10^6，也就是1s
  51   1            while(1){       
  52   2              led_display_scan(); 
  53   2              k = get_key();
C51 COMPILER V9.59.0.0   TIME_CLOCK                                                        03/21/2019 22:28:49 PAGE 2   

  54   2              key_shake_eliminate();
  55   2              if(k==-2) break;        
  56   2              count++;
  57   2              if(count==7){
  58   3                count=0;                    
  59   3                s++;
  60   3                if(s==60){
  61   4                  s=0;
  62   4                  m++;
  63   4                  if(m==60){
  64   5                    h++;
  65   5                    if(h==24)
  66   5                    h=0;            
  67   5                  }
  68   4                }
  69   3              concat(buf,arrhour[h],arrminute[m],arrsecond[s]);
  70   3              led_display_puts(buf);
  71   3            }
  72   2          }
  73   1      
  74   1      }
  75          
  76          /*void display_time1(char *bf){
  77            char buf[9],k;
  78            //concat(buf,arrhour[h],arrminute[m],arrsecond[s]);
  79            //concat(buf,"12","30","25"); 
  80            led_display_puts(bf);
  81                //运行一次大约执行31条指令（不考虑进入if）
  82                //有的指令周期为1，有的为2，我们取平均值1.5
  83                //1.5*31=46.5,   46.5*21500约等于10^6，也就是1s
  84                while(1){       
  85                  led_display_scan(); 
  86                  k = get_key();
  87                  key_shake_eliminate();
  88                  if(k==-2) break;        
  89                  count++;
  90                  if(count==7){
  91                    count=0;                    
  92                    s++;
  93                    if(s==60){
  94                      s=0;
  95                      m++;
  96                      if(m==60){
  97                        h++;
  98                        if(h==24)
  99                        h=0;            
 100                      }
 101                    }
 102                  concat(buf,arrhour[h],arrminute[m],arrsecond[s]);
 103                  led_display_puts(buf);
 104                }
 105              }
 106          }*/
 107          
 108          
 109          /*********************************************************************************************************
 110          ** Function name:           concat
 111          ** Descriptions:            将小时，分钟，秒数三个字符串拼接到buf字符串
 112          ** input parameters:        char *h,char *m, char *s
 113          ** output parameters:       buf
 114          ** Returned value:          none
 115          *********************************************************************************************************/
C51 COMPILER V9.59.0.0   TIME_CLOCK                                                        03/21/2019 22:28:49 PAGE 3   

 116          void concat(char buf[9],char *h,char *m, char *s){
 117   1        buf[0] = *h;
 118   1        buf[1] = h[1];
 119   1        buf[2]='.';
 120   1        buf[3] = *m;
 121   1        buf[4] = m[1];
 122   1        buf[5]='.';
 123   1        buf[6] = *s;
 124   1        buf[7] = s[1];
 125   1        buf[8] = '\0';
 126   1      }
 127          
 128          void set_time(){
 129   1        
 130   1      
 131   1      }
 132                              
 133          /*********************************************************************************************************
 134            END FILE
 135          *********************************************************************************************************/
 136          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    415    ----
   CONSTANT SIZE    =    632    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      2      25
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
